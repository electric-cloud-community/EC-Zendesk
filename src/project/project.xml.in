<?xml version="1.0" encoding="UTF-8"?>
<exportedData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="commander.xsd" version="61" buildLabel="build_4.2_77824_2014.09.27_02:09:10" buildVersion="4.2.6.77824" passkey="a30cbf89cfdae202c5227ce40fe867512295566d">
  <exportPath>/projects/@PLUGIN_KEY@</exportPath>
  <project>
    <projectName>@PLUGIN_KEY@</projectName>
    <description>Plugin to interact with Zendesk
Developped for the Citrix Hackathon</description>
    <resourceName/>
    <workspaceName/>
    <propertySheet>
      <property>
        <propertyName>configure</propertyName>
        <description/>
        <expandable>1</expandable>
        <value>1</value>
      </property>
      <property>
        <propertyName>ec_visibility</propertyName>
        <expandable>1</expandable>
        <value>pickListOnly</value>
      </property>
      <property>
        <propertyName>help</propertyName>
        <description/>
        <expandable>1</expandable>
        <value>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
    &lt;meta content="text/html; charset=us-ascii" http-equiv="content-type" /&gt;
    &lt;title&gt;EC-Zendesk Plugin&lt;/title&gt;
    &lt;link rel="stylesheet" href= "../../plugins/@PLUGIN_NAME@/pluginhelp.css" type="text/css" media= "screen" /&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div class="help"&gt;
        &lt;h1&gt;EC-Zendesk&lt;/h1&gt;
&lt;p&gt;Plugin Version @PLUGIN_VERSION@&lt;/p&gt;
        &lt;hr style="margin-left: -10px; margin-top: 10px; height: 1px; width: 100%; color: #5981BD;" noshade="noshade" /&gt;

        &lt;p&gt;EC-Zendesk is a collection of procedures to help you
interact with Zendesk.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;</value>
      </property>
      <property>
        <propertyName>pluginBuildNumber</propertyName>
        <expandable>1</expandable>
        <value>27</value>
      </property>
      <property>
        <propertyName>promoteAction</propertyName>
        <description>Upon promotion, copy the current credential and attach them to the steps</description>
        <expandable>0</expandable>
        <value>if ($upgradeAction eq "upgrade") {
    my $query   = $commander-&gt;newBatch();
    my $creds   = $query-&gt;getCredentials("\$[/plugins/$otherPluginName]");

    local $self-&gt;{abortOnError} = 0;
    $query-&gt;submit();


    # Copy configuration credentials and attach them to the appropriate steps
    my @nodes = $query-&gt;findnodes('credential');
        for (@nodes) {
            my $cred = $_-&gt;string_value;

            # Clone the credential
            $batch-&gt;clone(
                          {
                            path      =&gt; "/plugins/$otherPluginName/project/credentials/$cred",
                            cloneName =&gt; "/plugins/$pluginName/project/credentials/$cred"
                          }
                         );

            # Make sure the credential has an ACL entry for the new project principal
            my $xpath = $commander-&gt;getAclEntry(
                                                "user",
                                                "project: $pluginName",
                                                {
                                                   projectName    =&gt; $otherPluginName,
                                                   credentialName =&gt; $cred
                                                }
                                               );
            if ($xpath-&gt;findvalue('//code') eq 'NoSuchAclEntry') {
                $batch-&gt;deleteAclEntry(
                                       "user",
                                       "project: $otherPluginName",
                                       {
                                          projectName    =&gt; $pluginName,
                                          credentialName =&gt; $cred
                                       }
                                      );
                $batch-&gt;createAclEntry(
                                       "user",
                                       "project: $pluginName",
                                       {
                                          projectName                =&gt; $pluginName,
                                          credentialName             =&gt; $cred,
                                          readPrivilege              =&gt; "allow",
                                          modifyPrivilege            =&gt; "allow",
                                          executePrivilege           =&gt; "allow",
                                          changePermissionsPrivilege =&gt; "allow"
                                       }
                                      );
            }

            # Attach the credential to the appropriate steps
            $batch-&gt;attachCredential(
                                     "\$[/plugins/$pluginName/project]",
                                     $cred,
                                     {
                                        procedureName =&gt; 'commentOnTicket',
                                        stepName      =&gt; 'commentTicket'
                                     }
                                    );
            $batch-&gt;attachCredential(
                                     "\$[/plugins/$pluginName/project]",
                                     $cred,
                                     {
                                        procedureName =&gt; 'createTicket',
                                        stepName      =&gt; 'openTicket'
                                     }
                                    );
        }
    }
}

</value>
      </property>
      <property>
        <propertyName>version</propertyName>
        <description>Version of the EC-Zendesk project

History:
- version 1.0.0 initial version created for the Citrix hackathon
</description>
        <expandable>1</expandable>
        <value>1.0.0</value>
      </property>
      <property>
        <propertyName>zendeskURL</propertyName>
        <description/>
        <expandable>1</expandable>
        <value>https://electriccloud.zendesk.com/api/v2</value>
      </property>
    <property><propertyName>ec_setup</propertyName><value>PLACEHOLDER</value></property><property><propertyName>project_version</propertyName><value>@PLUGIN_VERSION@</value></property></propertySheet>
    <procedure>
      <procedureName>commentOnTicket</procedureName>
      <description>Comment on an existing  Zendesk Ticket</description>
      <jobNameTemplate/>
      <resourceName/>
      <timeLimit/>
      <timeLimitUnits>minutes</timeLimitUnits>
      <workspaceName/>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>Title</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>comment</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>credential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>product</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>options</propertyName>
                      <propertySheet>
                        <property>
                          <propertyName>option1</propertyName>
                          <propertySheet>
                            <property>
                              <propertyName>text</propertyName>
                              <expandable>1</expandable>
                              <value>ElectricCommander</value>
                            </property>
                            <property>
                              <propertyName>value</propertyName>
                              <expandable>1</expandable>
                              <value>electriccommander</value>
                            </property>
                          </propertySheet>
                        </property>
                        <property>
                          <propertyName>option2</propertyName>
                          <propertySheet>
                            <property>
                              <propertyName>text</propertyName>
                              <expandable>1</expandable>
                              <value>ElectricFlow</value>
                            </property>
                            <property>
                              <propertyName>value</propertyName>
                              <expandable>1</expandable>
                              <value>electricflow</value>
                            </property>
                          </propertySheet>
                        </property>
                        <property>
                          <propertyName>list</propertyName>
                          <expandable>1</expandable>
                          <value>ElectricCommander|ElectricFlow</value>
                        </property>
                        <property>
                          <propertyName>optionCount</propertyName>
                          <expandable>1</expandable>
                          <value>2</value>
                        </property>
                        <property>
                          <propertyName>type</propertyName>
                          <expandable>1</expandable>
                          <value>list</value>
                        </property>
                      </propertySheet>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketBody</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketDescription</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketNumber</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketSubject</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>zendeskURL</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
        <property>
          <propertyName>exposeToPlugin</propertyName>
          <description/>
          <expandable>1</expandable>
          <value>1</value>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>comment</formalParameterName>
        <defaultValue/>
        <description>The comment you want to add to the ticket</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>textarea</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>credential</formalParameterName>
        <defaultValue>zendesk</defaultValue>
        <description/>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>ticketNumber</formalParameterName>
        <defaultValue/>
        <description>The Zendesk ticket number to add a comment on</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <step>
        <stepName>commentTicket</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command>PLACEHOLDER</command>
        <condition/>
        <description/>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName/>
        <parallel>0</parallel>
        <postProcessor/>
        <precondition/>
        <releaseMode>none</releaseMode>
        <resourceName/>
        <shell>ec-perl</shell>
        <timeLimit/>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory/>
        <workspaceName/>
        <propertySheet>
        </propertySheet>
      </step>
    </procedure>
    <procedure>
      <procedureName>createTicket</procedureName>
      <description>Create a Zendesk Ticket</description>
      <jobNameTemplate/>
      <resourceName/>
      <timeLimit/>
      <timeLimitUnits>minutes</timeLimitUnits>
      <workspaceName/>
      <propertySheet>
        <property>
          <propertyName>ec_customEditorData</propertyName>
          <propertySheet>
            <property>
              <propertyName>parameters</propertyName>
              <propertySheet>
                <property>
                  <propertyName>Title</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>credential</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>product</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>options</propertyName>
                      <propertySheet>
                        <property>
                          <propertyName>option1</propertyName>
                          <propertySheet>
                            <property>
                              <propertyName>text</propertyName>
                              <expandable>1</expandable>
                              <value>ElectricCommander</value>
                            </property>
                            <property>
                              <propertyName>value</propertyName>
                              <expandable>1</expandable>
                              <value>electriccommander</value>
                            </property>
                          </propertySheet>
                        </property>
                        <property>
                          <propertyName>option2</propertyName>
                          <propertySheet>
                            <property>
                              <propertyName>text</propertyName>
                              <expandable>1</expandable>
                              <value>ElectricFlow</value>
                            </property>
                            <property>
                              <propertyName>value</propertyName>
                              <expandable>1</expandable>
                              <value>electricflow</value>
                            </property>
                          </propertySheet>
                        </property>
                        <property>
                          <propertyName>list</propertyName>
                          <expandable>1</expandable>
                          <value>ElectricCommander|ElectricFlow</value>
                        </property>
                        <property>
                          <propertyName>optionCount</propertyName>
                          <expandable>1</expandable>
                          <value>2</value>
                        </property>
                        <property>
                          <propertyName>type</propertyName>
                          <expandable>1</expandable>
                          <value>list</value>
                        </property>
                      </propertySheet>
                    </property>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketBody</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketDescription</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>ticketSubject</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>version</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
                <property>
                  <propertyName>zendeskURL</propertyName>
                  <propertySheet>
                    <property>
                      <propertyName>formType</propertyName>
                      <expandable>1</expandable>
                      <value>standard</value>
                    </property>
                  </propertySheet>
                </property>
              </propertySheet>
            </property>
          </propertySheet>
        </property>
        <property>
          <propertyName>exposeToPlugin</propertyName>
          <description/>
          <expandable>1</expandable>
          <value>1</value>
        </property>
      </propertySheet>
      <formalParameter>
        <formalParameterName>credential</formalParameterName>
        <defaultValue>zendesk</defaultValue>
        <description>Nameof the credential to use.</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>product</formalParameterName>
        <defaultValue>electriccommander</defaultValue>
        <description/>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>select</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>ticketDescription</formalParameterName>
        <defaultValue>This ticket has been created automatically by $[/myProject/projectName]:$[/myProcedure/procedureName]</defaultValue>
        <description>The full description of the ticket</description>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>textarea</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>ticketSubject</formalParameterName>
        <defaultValue>TEST ignore - $[/increment /server/counters/$[/myProject/projectName]/jobCounter]</defaultValue>
        <description/>
        <expansionDeferred>0</expansionDeferred>
        <required>1</required>
        <type>entry</type>
      </formalParameter>
      <formalParameter>
        <formalParameterName>version</formalParameterName>
        <defaultValue/>
        <description>Product version</description>
        <expansionDeferred>0</expansionDeferred>
        <required>0</required>
        <type>entry</type>
      </formalParameter>
      <step>
        <stepName>openTicket</stepName>
        <alwaysRun>0</alwaysRun>
        <broadcast>0</broadcast>
        <command>PLACEHOLDER</command>
        <condition/>
        <description/>
        <errorHandling>failProcedure</errorHandling>
        <exclusiveMode>none</exclusiveMode>
        <logFileName/>
        <parallel>0</parallel>
        <postProcessor/>
        <precondition/>
        <releaseMode>none</releaseMode>
        <resourceName/>
        <shell>ec-perl</shell>
        <timeLimit/>
        <timeLimitUnits>minutes</timeLimitUnits>
        <workingDirectory/>
        <workspaceName/>
        <propertySheet>
        </propertySheet>
      </step>
    </procedure>
  </project>
</exportedData>
